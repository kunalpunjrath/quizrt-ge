<!doctype html>
<html>

<head>
  <title>Game console</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font: 13px Helvetica, Arial;
    }

    form {
      background: #000;
      padding: 3px;
      position: fixed;
      bottom: 0;
      width: 100%;
    }

    form input {
      border: 0;
      padding: 10px;
      width: 90%;
      margin-right: .5%;
    }

    form button {
      width: 9%;
      background: rgb(130, 224, 255);
      border: none;
      padding: 10px;
    }

    #messages {
      list-style-type: none;
      margin: 0;
      padding: 0;
    }

    #messages li {
      padding: 5px 10px;
    }

    #messages li:nth-child(odd) {
      background: #eee;
    }

    #messages {
      margin-bottom: 40px
    }

  </style>
</head>

<body>
  <h3>Game Console</h3>
  <ul id="messages"></ul>

  <button id="start">Start game</button>
  <button id="end">Quit game</button>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.js"></script>
  <script src="https://code.jquery.com/jquery-1.11.1.js"></script>

  <script>
    $(function () {
      var start = io.connect('http://127.0.0.1:3001/start');
      var  playerIds  = ['p1',  'p2',  'p3',  'p4'];
      var  gamestart  = {
        "topicid": "T1",
        "playerid":  playerIds[Math.floor(Math.random() *  Math.floor(4))]
      };
      var events = {
        INITIATEGAME: 'Client Event trigger to start game',
        GAMEID: 'Server Event trigger on generating game ID',
        STARTQUIZ: 'Client Event trigger to fetch questions',
        QUESTION: 'Server Event trigger on sending across question',
        ENDGAME: 'Client Event trigger to abruptly end game'
      };
      $('#start').click(function () {
        start.emit(events.INITIATEGAME, gamestart);
      });

      start.on(events.GAMEID, function (data) {
        //on receive of data create a new io connection with name space 'game id' received
        var gameId = data.gameId;
        console.log('GameID generated :: ', gameId);
        var gameison = io.connect('http://127.0.0.1:3000/' + gameId);
        gameison.emit(events.STARTQUIZ, 'Client request for Quiz questions');
        gameison.on(events.QUESTION, function (data) {
          console.log('Question :: ', data);
        });
      });

      $('#end').click(function () {
        start.emit(events.ENDGAME, 'Client abruptly ended game');
      });
    });

  </script>
</body>

</html>
